# Groq API 설정 가이드

## 개요

Groq Llama3를 사용하여 의료 용어 없이 마케팅 문구만 생성하는 AI 기능입니다.

## 환경 변수 설정

`.env.local` 파일에 다음 변수를 추가하세요:

```env
GROQ_API_KEY=your_groq_api_key_here
```

## Groq API 키 발급

### 1. Groq 계정 생성

1. [Groq Console](https://console.groq.com) 접속
2. 회원가입 또는 로그인
3. API Keys 메뉴로 이동

### 2. API 키 생성

1. Groq Console > **API Keys** 메뉴 선택
2. **Create API Key** 클릭
3. API 키 이름 입력 (예: "닥터스플로우 마케팅")
4. 생성된 API 키 복사
5. `.env.local` 파일에 `GROQ_API_KEY`로 설정

## 사용 방법

### 환자 마케팅 페이지에서 사용

1. 대시보드 > **환자 마케팅** 메뉴 접속
2. **AI 마케팅 문구 생성기** 섹션에서 프롬프트 입력
3. "문구 생성" 또는 "3개 생성" 버튼 클릭
4. 생성된 문구 확인 및 복사

### 프롬프트 예시

**좋은 예시:**
- "생일 할인 이벤트 안내"
- "예약 확인 및 리마인더"
- "신규 고객 환영 쿠폰"
- "재방문 유도 프로모션"
- "리뷰 작성 감사 이벤트"

**피해야 할 예시:**
- "증상이 있으시면 방문해주세요" (의료 용어 포함)
- "진단 결과 안내" (의료 용어 포함)
- "치료 과정 설명" (의료 용어 포함)

## 필터링 규칙

### 차단되는 의료 용어

다음 용어가 포함된 문구는 자동으로 차단됩니다:
- 증상, 진단, 질병, 병, 치료, 수술, 시술
- 처방, 약물, 약, 병원, 의사, 의료진
- 검사, 진료, 병리, 증후, 합병증

### 허용되는 마케팅 키워드

다음 키워드가 포함되어야 합니다:
- 할인, 이벤트, 예약, 안내, 쿠폰
- 프로모션, 특가, 혜택, 서비스
- 방문, 상담, 문의, 리뷰, 후기
- 만족, 추천

## API 엔드포인트

### 단일 문구 생성

```typescript
POST /api/groq/generate-marketing
Content-Type: application/json

{
  "prompt": "생일 할인 이벤트 안내"
}
```

### 여러 버전 생성

```typescript
POST /api/groq/generate-marketing
Content-Type: application/json

{
  "prompt": "예약 확인 리마인더",
  "count": 3
}
```

## 응답 형식

### 성공 응답

```json
{
  "success": true,
  "text": "생성된 마케팅 문구...",
  "attempts": 1
}
```

또는 여러 버전:

```json
{
  "success": true,
  "texts": [
    "생성된 문구 1...",
    "생성된 문구 2...",
    "생성된 문구 3..."
  ]
}
```

### 실패 응답

```json
{
  "success": false,
  "error": "의료 용어가 포함되어 있습니다.",
  "attempts": 3
}
```

## 자동 검증 프로세스

1. **프롬프트 검증**: 사용자 입력 프롬프트 확인
2. **AI 생성**: Groq Llama3로 문구 생성
3. **의료 용어 필터링**: 차단 목록 확인
4. **마케팅 키워드 확인**: 허용 목록 확인
5. **재시도**: 검증 실패 시 최대 3회 재시도
6. **결과 반환**: 검증 통과 시 문구 반환

## 모델 정보

- **모델**: `llama-3.1-70b-versatile`
- **Temperature**: 0.7 (다양성 조절)
- **Max Tokens**: 200 (최대 길이)
- **재시도 횟수**: 최대 3회

## 주의사항

1. **API 키 보안**: API 키는 절대 공개하지 마세요
2. **과금**: Groq API는 무료 티어가 있지만 사용량 제한이 있습니다
3. **의료 용어**: 시스템이 자동으로 필터링하지만, 생성된 문구는 항상 확인하세요
4. **법적 책임**: 생성된 문구의 법적 책임은 사용자에게 있습니다

## 문제 해결

### API 키 오류

- `GROQ_API_KEY`가 올바르게 설정되었는지 확인
- Groq Console에서 API 키가 활성화되어 있는지 확인

### 생성 실패

- 프롬프트에 의료 용어가 포함되지 않았는지 확인
- 마케팅 관련 키워드가 포함되었는지 확인
- 네트워크 연결 상태 확인

### 검증 실패

- 생성된 문구가 자동으로 필터링됩니다
- 최대 3회 재시도 후에도 실패하면 오류 메시지 확인

## 참고 자료

- [Groq Documentation](https://console.groq.com/docs)
- [Groq Console](https://console.groq.com)
- [Llama 3.1 모델 정보](https://console.groq.com/docs/models)

