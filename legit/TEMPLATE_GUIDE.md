# 템플릿 빌더 사용 가이드

## 개요

닥터스플로우의 템플릿 빌더는 노코드 방식으로 마케팅 메시지 템플릿을 생성하고 관리할 수 있는 기능입니다.

## 주요 기능

### 1. 드래그 앤 드롭
- 템플릿 카드 왼쪽의 그립 아이콘(⋮⋮)을 드래그하여 순서 변경
- 드래그 중 시각적 피드백 제공 (투명도 변경)

### 2. 템플릿 편집
- 편집 버튼 클릭 시 다이얼로그 열림
- 템플릿 이름, 설명 수정 가능
- 트리거 설정 변경 가능
- 메시지 추가/삭제/수정 가능

### 3. 템플릿 활성화/비활성화
- 각 템플릿의 스위치로 활성화 상태 토글
- 비활성화된 템플릿은 자동 발송되지 않음

### 4. 템플릿 삭제
- 삭제 버튼 클릭 시 확인 다이얼로그 표시
- 확인 시 템플릿이 영구 삭제됨

## 기본 템플릿

### 1. 예약 완료 리마인더
**트리거**: 예약 완료 시  
**채널**: 카카오톡 + SMS  
**용도**: 예약이 완료되면 환자에게 예약 정보를 확인시켜주는 리마인더 발송

**변수**:
- `{{patient_name}}` - 환자 이름
- `{{appointment_date}}` - 예약 날짜
- `{{appointment_time}}` - 예약 시간

### 2. 수술 후 후기 요청
**트리거**: 수술 후 3일째  
**채널**: SMS  
**용도**: 수술 후 회복 상태를 확인하고 후기 작성을 유도

**변수**:
- `{{patient_name}}` - 환자 이름
- `{{review_link}}` - 후기 작성 링크

### 3. 생일 할인 쿠폰
**트리거**: 생일 3일 전  
**채널**: 카카오톡  
**용도**: 생일을 맞이한 환자에게 할인 쿠폰 제공

**변수**:
- `{{patient_name}}` - 환자 이름
- `{{coupon_expiry}}` - 쿠폰 유효기간
- `{{coupon_code}}` - 쿠폰 번호

### 4. 재방문 유도
**트리거**: 3개월 미방문  
**채널**: SMS  
**용도**: 오랜만에 방문하지 않은 환자에게 재방문 유도

**변수**:
- `{{patient_name}}` - 환자 이름
- `{{booking_link}}` - 예약 링크
- `{{phone_number}}` - 병원 전화번호

### 5. Naver 리뷰 작성 유도
**트리거**: 리뷰 요청  
**채널**: 카카오톡  
**용도**: 만족한 환자에게 Naver 리뷰 작성을 유도

**변수**:
- `{{patient_name}}` - 환자 이름
- `{{naver_review_link}}` - Naver 리뷰 작성 링크

## 템플릿 편집 방법

### 1. 기본 정보 수정
1. 편집 버튼 클릭
2. 템플릿 이름과 설명 수정
3. 저장 버튼 클릭

### 2. 트리거 설정
1. 트리거 유형 선택
   - 예약 완료 시
   - 수술 후 N일째
   - 생일 N일 전
   - N개월 미방문
   - 리뷰 요청
2. 필요한 경우 값 입력 (일수 또는 개월수)

### 3. 메시지 관리
1. **메시지 추가**
   - "메시지 추가" 버튼 클릭
   - 발송 채널 선택 (카톡/SMS/둘 다)
   - 메시지 내용 입력

2. **메시지 수정**
   - 메시지 내용 텍스트 영역에서 직접 수정
   - 변수는 `{{변수명}}` 형식으로 사용

3. **메시지 삭제**
   - 메시지 카드 우측 상단의 X 버튼 클릭

### 4. 변수 사용
템플릿 메시지에서 다음과 같은 변수를 사용할 수 있습니다:

- `{{patient_name}}` - 환자 이름
- `{{appointment_date}}` - 예약 날짜
- `{{appointment_time}}` - 예약 시간
- `{{review_link}}` - 후기 작성 링크
- `{{coupon_code}}` - 쿠폰 번호
- `{{coupon_expiry}}` - 쿠폰 유효기간
- `{{booking_link}}` - 예약 링크
- `{{phone_number}}` - 병원 전화번호
- `{{naver_review_link}}` - Naver 리뷰 링크

## 데이터 저장

- 모든 템플릿은 브라우저의 로컬 스토리지에 자동 저장됩니다
- 템플릿 순서 변경, 편집, 삭제 등 모든 변경사항이 즉시 저장됩니다
- 브라우저를 닫아도 템플릿이 유지됩니다

## 주의사항

1. **로컬 스토리지 제한**
   - 브라우저별로 저장 용량 제한이 있습니다
   - 다른 브라우저나 기기에서는 템플릿이 공유되지 않습니다

2. **변수 치환**
   - 현재는 템플릿 편집만 가능하며, 실제 발송 시 변수 치환은 별도 구현이 필요합니다

3. **템플릿 실행**
   - 템플릿을 실제로 실행하려면 스케줄러나 트리거 시스템이 필요합니다

## 향후 개선 계획

1. **템플릿 미리보기**
   - 변수를 실제 값으로 치환한 미리보기 기능

2. **템플릿 복제**
   - 기존 템플릿을 복제하여 새 템플릿 생성

3. **템플릿 그룹화**
   - 카테고리별로 템플릿 그룹화

4. **발송 이력**
   - 템플릿별 발송 이력 확인

5. **A/B 테스트**
   - 여러 버전의 템플릿 테스트 및 비교

